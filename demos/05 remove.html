<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>步骤5：删除功能</title>
    <style>
        [v-cloak]{display:none}
        body{font-family:system-ui;margin:20px}
        table{border-collapse:collapse;width:480px;max-width:100%}
        th,td{border:1px solid #ccc;padding:8px;text-align:left}
        button{padding:6px 10px}
    </style>
</head>
<body>
<div id="app" v-cloak>
    <h1>{{ title }}</h1>

    <table>
        <thead>
        <tr>
            <th>名称</th>
            <th>血量</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <tr v-for="h in heroes" v-bind:key="h.id">
            <td>{{ h.name }}</td>
            <td>{{ h.hp }}</td>
            <td>
                <button type="button" v-on:click="removeHero(h.id)">删除</button>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
<script>
    (function () {
        var ref = Vue.ref;

        // 纯函数
        function findHeroIndexById(list, heroId) {
            var i;
            for (i = 0; i < list.length; i = i + 1) {
                if (list[i].id === heroId) return i;
            }
            return -1;
        }

        function removeHeroFromList(list, heroId) {
            var idx = findHeroIndexById(list, heroId);
            if (idx === -1) return list;
            var copy = list.slice();
            copy.splice(idx, 1);
            return copy;
        }

        var app = Vue.createApp({
            setup: function () {
                var title = ref('英雄管理面板（步骤5）');
                var heroes = ref([
                    { id: 1, name: '盖伦', hp: 318 },
                    { id: 2, name: '提莫', hp: 320 },
                    { id: 3, name: '安妮', hp: 419 }
                ]);

                function removeHero(heroId) {
                    heroes.value = removeHeroFromList(heroes.value, heroId);
                }

                return {
                    title: title,
                    heroes: heroes,
                    removeHero: removeHero
                };
            }
        });

        app.mount('#app');
    })();
</script>
</body>
</html>